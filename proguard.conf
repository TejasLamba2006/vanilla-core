# ProGuard Configuration for Vanilla Core Plugin
# ============================================
# AGGRESSIVE OBFUSCATION MODE
# ============================================

# Maximum optimization passes
-optimizationpasses 5
-allowaccessmodification
-mergeinterfacesaggressively

# Repackage internal classes but keep feature package for reflection scanning
-repackageclasses 'a'

# Keep annotations (needed for Bukkit events)
-keepattributes *Annotation*,Signature,Exceptions

# ============================================
# SUPPRESS WARNINGS
# ============================================

-dontwarn org.bukkit.**
-dontwarn org.spigotmc.**
-dontwarn net.md_5.**
-dontwarn com.sk89q.**
-dontwarn javax.**
-dontwarn java.awt.**
-dontwarn com.destroystokyo.**
-dontwarn io.papermc.**

# ============================================
# REQUIRED KEEPS FOR PLUGIN TO FUNCTION
# ============================================

# Main plugin class - ONLY the class name and onEnable/onDisable
-keep public class com.tejaslamba.vanillacore.Main {
    public void onEnable();
    public void onDisable();
}

# Feature classes - Keep class names for reflection scanning (FeatureManager finds them by package)
# But obfuscate all internal method names except those inherited from Feature interface
-keep public class com.tejaslamba.vanillacore.features.* {
    public <init>();
}

# Feature interface - Keep method signatures for polymorphism
-keep public interface com.tejaslamba.vanillacore.feature.Feature {
    *;
}

# BaseFeature - Keep for inheritance
-keep public class com.tejaslamba.vanillacore.feature.BaseFeature {
    public protected *;
}

# Command executors - ONLY the interface method
-keep public class * implements org.bukkit.command.CommandExecutor {
    public boolean onCommand(org.bukkit.command.CommandSender, org.bukkit.command.Command, java.lang.String, java.lang.String[]);
}
-keep public class * implements org.bukkit.command.TabCompleter {
    public java.util.List onTabComplete(org.bukkit.command.CommandSender, org.bukkit.command.Command, java.lang.String, java.lang.String[]);
}

# Event listeners - ONLY methods with @EventHandler annotation
-keepclassmembers class * implements org.bukkit.event.Listener {
    @org.bukkit.event.EventHandler <methods>;
}

# ============================================
# ENUMS - Required by Java
# ============================================

-keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
}

# ============================================
# AGGRESSIVE OBFUSCATION DICTIONARIES
# ============================================

-obfuscationdictionary proguard-dictionary.txt
-classobfuscationdictionary proguard-dictionary.txt
-packageobfuscationdictionary proguard-dictionary.txt

# Use short meaningless names
-useuniqueclassmembernames
